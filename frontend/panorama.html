<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panorama Mensal Resumido - Superendividamento</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: url('SuperEndBackgroundTransparente.png') no-repeat center center fixed;
            background-size: cover;
        }
        .container { max-width: 1200px; margin: 30px auto; background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 2px 8px #0001; }
        .titulo-topo { font-size: 1.1em; font-weight: bold; text-align: center; }
        .panorama-title { color: #0074d9; font-weight: bold; font-size: 1.3em; text-align: center; margin: 20px 0 30px 0; }
        .retangulo { border: 2px solid #bbb; border-radius: 10px; margin-bottom: 18px; background: #f8f9fa; padding: 18px 18px 10px 18px; position: relative; }
        .retangulo-verde { background: #e6f9e6; border: 2px solid #7ed87e; }
        .retangulo-icone { width: 60px; height: 60px; display: flex; align-items: center; justify-content: center; font-size: 2.5em; float: left; margin-right: 18px; }
        .retangulo-titulo { font-weight: bold; font-size: 1.1em; margin-bottom: 6px; }
        .retangulo-valor { font-size: 2em; font-weight: bold; color: #007a00; }
        .retangulo-valor-neg { color: #d00; }
        .retangulo-valor-pct { font-size: 1.2em; font-weight: bold; color: #0074d9; }
        .retangulo-label { font-size: 1em; color: #333; }
        .retangulo-autos { position: absolute; right: 18px; top: 18px; background: #c6f5c6; border: 2px solid #7ed87e; border-radius: 6px; padding: 8px 18px; font-size: 1.1em; font-weight: bold; color: #fff; }
        .retangulo-obs { font-size: 0.95em; color: #444; margin-top: 10px; }
        .retangulo-icone-alarme { color: #ff9800; }
        .retangulo-icone-dinheiro { color: #007a00; }
        .retangulo-icone-folha { color: #0074d9; }
        .retangulo-icone-cartao { color: #d00; }
        .retangulo-icone-comprometido { color: #e91e63; }
        .retangulo-icone-outros { color: #9c27b0; }
        .retangulo-icone-emergencial { color: #ff9800; }
        .retangulo-pct-limite { color: #2e7d32; font-size: 1.5em; font-weight: bold; }
        .retangulo-valor-livre { color: #007a00; font-size: 1.3em; font-weight: bold; }
        .retangulo-valor-neg { color: #d00; }
        .retangulo-valor-porcento { font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-neg { color: #d00; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-verde { color: #2e7d32; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-alarme { color: #ff9800; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-azul { color: #0074d9; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-cinza { color: #888; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-preto { color: #000; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-roxo { color: #9c27b0; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-rosa { color: #e91e63; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-vermelho { color: #d00; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-laranja { color: #ff9800; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-amarelo { color: #ffc107; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-azul-claro { color: #03a9f4; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-verde-claro { color: #8bc34a; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-cinza-claro { color: #bdbdbd; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-preto-claro { color: #333; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-roxo-claro { color: #ce93d8; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-rosa-claro { color: #f8bbd0; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-vermelho-claro { color: #ffcdd2; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-laranja-claro { color: #ffe0b2; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-amarelo-claro { color: #fff9c4; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-azul-claro2 { color: #b3e5fc; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-verde-claro2 { color: #dcedc8; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-cinza-claro2 { color: #f5f5f5; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-preto-claro2 { color: #757575; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-roxo-claro2 { color: #e1bee7; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-rosa-claro2 { color: #fce4ec; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-vermelho-claro2 { color: #ffcdd2; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-laranja-claro2 { color: #ffe0b2; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-amarelo-claro2 { color: #fff9c4; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-azul-claro3 { color: #b3e5fc; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-verde-claro3 { color: #dcedc8; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-cinza-claro3 { color: #f5f5f5; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-preto-claro3 { color: #757575; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-roxo-claro3 { color: #e1bee7; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-rosa-claro3 { color: #fce4ec; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-vermelho-claro3 { color: #ffcdd2; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-laranja-claro3 { color: #ffe0b2; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-amarelo-claro3 { color: #fff9c4; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-azul-claro4 { color: #b3e5fc; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-verde-claro4 { color: #dcedc8; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-cinza-claro4 { color: #f5f5f5; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-preto-claro4 { color: #757575; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-roxo-claro4 { color: #e1bee7; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-rosa-claro4 { color: #fce4ec; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-vermelho-claro4 { color: #ffcdd2; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-laranja-claro4 { color: #ffe0b2; font-size: 1.1em; font-weight: bold; }
        .retangulo-valor-porcento-amarelo-claro4 { color: #fff9c4; font-size: 1.1em; font-weight: bold; }
        h1 { color: #2d5c2f; margin-bottom: 20px; }
        #custom-navbar {
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            background: linear-gradient(90deg, #e0ffe0 0%, #baffba 100%);
            box-shadow: 0 2px 8px #0002;
            border-radius: 0 0 16px 16px;
            padding: 6px 8px;
            margin-bottom: 18px;
            border: none;
        }
        .nav-btn {
            flex: 1;
            background: transparent;
            border: none;
            font-size: 1em;
            padding: 10px 0;
            cursor: pointer;
            transition: background 0.2s, color 0.2s, font-weight 0.2s;
            color: #2d5c2f;
            border-bottom: 3px solid transparent;
            border-radius: 0 0 12px 12px;
            margin: 0 4px;
        }
        .nav-btn:focus,
        .nav-btn:active,
        .nav-btn:hover,
        .nav-btn.active {
            background: #baffba;
            color: #007a00;
            font-weight: bold;
            border-bottom: 3px solid #007a00;
            outline: none;
        }
        table { font-size: 0.88rem; }
        th, td { padding: 0.3em 0.5em !important; }
        .form-control.input-sm, .form-control.input-md, .form-control.input-lg, .form-control.input-xs {
            min-height: 28px;
            font-size: 0.92em;
            padding: 2px 6px;
        }
        .limpar-btn, .imprimir-btn {
            border: 1.5px solid #baffba !important;
            color: #2d5c2f !important;
            background: #baffba !important;
            font-weight: bold;
            transition: border 0.2s;
        }
        .imprimir-btn:hover, .imprimir-btn:focus, .imprimir-btn:active {
            border: 1.5px solid #2d5c2f !important;
            color: #2d5c2f !important;
            background: #baffba !important;
        }
        .dark-theme .imprimir-btn,
        .dark-theme .imprimir-btn.btn-success,
        .dark-theme .btn.imprimir-btn,
        .dark-theme .btn-success.imprimir-btn {
            border: 1.5px solid #baffba !important;
            color: #baffba !important;
            background: transparent !important;
        }
        .dark-theme .imprimir-btn:hover,
        .dark-theme .imprimir-btn:focus,
        .dark-theme .imprimir-btn:active,
        .dark-theme .imprimir-btn.btn-success:hover,
        .dark-theme .imprimir-btn.btn-success:focus,
        .dark-theme .imprimir-btn.btn-success:active {
            border: 1.5px solid #baffba !important;
            color: #baffba !important;
            background: #23272b !important;
        }
        .container.dark-theme { background: rgba(35,39,43,0.65) !important; color: #fff !important; box-shadow: 0 2px 8px #0008; }
        .retangulo.dark-theme { background: rgba(35,39,43,0.65) !important; border-color: #444 !important; }
        .retangulo-verde.dark-theme { background: rgba(30,43,30,0.65) !important; border-color: #4caf50 !important; }
        .retangulo-autos.dark-theme { background: rgba(35,39,43,0.65) !important; color: #fff !important; border-color: #4caf50 !important; }
        /* === CSS DARK MODE E TABELAS (idêntico ao da index.html) === */
        table.dark-theme tr {
            background: transparent !important;
        }
        table.dark-theme th, table.dark-theme td {
            background: rgba(35,39,43,0.15) !important;
            color: #fff !important;
        }
        table.dark-theme {
            background: rgba(35,39,43,0.65) !important;
        }
        table.dark-theme thead, table.dark-theme tfoot {
            background: transparent !important;
            color: #fff !important;
        }
        table.dark-theme .total-row.dark-theme td,
        table.dark-theme .total-row.dark-theme {
            background: #23272b !important;
            color: #fff !important;
        }
        table.table.table-bordered.dark-theme,
        table.table.dark-theme,
        table.dark-theme {
            background: rgba(35,39,43,0.65) !important;
        }
        table.table.table-bordered.dark-theme th,
        table.table.table-bordered.dark-theme td,
        table.table.dark-theme th,
        table.table.dark-theme td,
        table.dark-theme th,
        table.dark-theme td {
            background: rgba(35,39,43,0.15) !important;
            color: #fff !important;
        }
        table.table.table-bordered.dark-theme tr,
        table.table.dark-theme tr,
        table.dark-theme tr {
            background: transparent !important;
        }
        table.table.table-bordered.dark-theme thead,
        table.table.table-bordered.dark-theme tfoot,
        table.table.dark-theme thead,
        table.table.dark-theme tfoot,
        table.dark-theme thead,
        table.dark-theme tfoot {
            background: #23272b !important;
            color: #fff !important;
        }
        table.table.table-bordered.dark-theme .total-row,
        table.table.table-bordered.dark-theme .total-row td,
        table.table.dark-theme .total-row,
        table.table.dark-theme .total-row td,
        table.dark-theme .total-row,
        table.dark-theme .total-row td {
            background: #23272b !important;
            color: #fff !important;
        }
        .retangulo.dark-theme { background: rgba(35,39,43,0.65) !important; border-color: #444 !important; }
        .retangulo-verde.dark-theme { background: rgba(30,43,30,0.65) !important; border-color: #4caf50 !important; }
        .retangulo-autos.dark-theme { background: rgba(35,39,43,0.65) !important; color: #fff !important; border-color: #4caf50 !important; }
        body.dark-theme, .container.dark-theme, .retangulo.dark-theme, .retangulo-verde.dark-theme, .retangulo-autos.dark-theme, .panorama-title.dark-theme, .retangulo-titulo.dark-theme, .retangulo-label.dark-theme, .retangulo-valor.dark-theme, .retangulo-valor-neg.dark-theme, .retangulo-valor-porcento.dark-theme, .retangulo-pct-limite.dark-theme, .retangulo-obs.dark-theme {
          color: #fff !important;
        }
        body.dark-theme * { color: #fff !important; }
        .retangulo-autos.dark-theme { background: rgba(35,39,43,0.65) !important; color: #fff !important; border-color: #4caf50 !important; }
        body.dark-theme #btn-theme-toggle { background: rgba(35,39,43,0.32) !important; color: #fff !important; }
        body.dark-theme .retangulo-autos {
          background: rgba(35,39,43,0.65) !important;
          color: #fff !important;
          border-color: #4caf50 !important;
        }
        html.dark-theme .container, body.dark-theme .container { background: rgba(35,39,43,0.32) !important; color: #fff !important; box-shadow: 0 2px 8px #0008; }
        html.dark-theme .retangulo, body.dark-theme .retangulo { background: rgba(35,39,43,0.32) !important; border-color: #444 !important; }
        html.dark-theme .retangulo-verde, body.dark-theme .retangulo-verde { background: rgba(30,43,30,0.32) !important; border-color: #4caf50 !important; }
        html.dark-theme .retangulo-autos, body.dark-theme .retangulo-autos { background: rgba(35,39,43,0.32) !important; color: #fff !important; border-color: #4caf50 !important; }
        html.dark-theme #btn-theme-toggle, body.dark-theme #btn-theme-toggle { background: rgba(35,39,43,0.32) !important; color: #fff !important; }
        html.dark-theme .panorama-title, body.dark-theme .panorama-title { color: #fff !important; background: rgba(35,39,43,0.32) !important; }
        html.dark-theme .retangulo-titulo, body.dark-theme .retangulo-titulo,
        html.dark-theme .retangulo-label, body.dark-theme .retangulo-label,
        html.dark-theme .retangulo-valor, body.dark-theme .retangulo-valor,
        html.dark-theme .retangulo-valor-neg, body.dark-theme .retangulo-valor-neg,
        html.dark-theme .retangulo-valor-porcento, body.dark-theme .retangulo-valor-porcento,
        html.dark-theme .retangulo-pct-limite, body.dark-theme .retangulo-pct-limite,
        html.dark-theme .retangulo-obs, body.dark-theme .retangulo-obs {
          color: #fff !important;
        }
        html.dark-theme *, body.dark-theme * { color: #fff !important; }
        html.dark-theme table, body.dark-theme table { background: rgba(35,39,43,0.32) !important; }
        html.dark-theme th, body.dark-theme th, html.dark-theme td, body.dark-theme td { background: rgba(35,39,43,0.12) !important; color: #fff !important; }
        @media print {
          #custom-navbar,
          .navbar,
          #theme-toggle,
          #btn-theme-toggle,
          #btn-imprimir,
          #limpar-btn,
          .limpar-btn {
            display: none !important;
          }
          #logo-superend,
          body > div[style*="position:sticky"],
          #btn-theme-toggle {
            display: none !important;
          }
          /* Esconde o fundo branco do container, mas mantém o conteúdo */
          .container {
            background: none !important;
            box-shadow: none !important;
            border-radius: 0 !important;
            padding: 0 !important;
          }
        }
    </style>
    <style id="dark-theme-style" disabled>
      body.dark-theme {
        background: url('SuperEndBackgroundTransparente-Dark.png') no-repeat center center fixed !important;
        background-size: cover !important;
        color: #fff !important;
      }
      html.dark-theme { background: #181a1b !important; }
      .container.dark-theme { background: rgba(35,39,43,0.65) !important; color: #fff !important; box-shadow: 0 2px 8px #0008; }
      h1.dark-theme, h2.dark-theme, h3.dark-theme, h4.dark-theme, h5.dark-theme, h6.dark-theme {
        color: #fff !important;
        background: transparent !important;
      }
      .retangulo.dark-theme {
        background: rgba(35,39,43,0.65) !important;
        border-color: #444 !important;
      }
      .retangulo-verde.dark-theme {
        background: rgba(30,43,30,0.65) !important;
        border-color: #4caf50 !important;
      }
      .retangulo-valor.dark-theme, .retangulo-valor-porcento.dark-theme, .retangulo-label.dark-theme, .retangulo-autos.dark-theme {
        color: #baffba !important;
      }
      .retangulo-valor-neg.dark-theme {
        color: #ff7b7b !important;
      }
      .retangulo-icone.dark-theme {
        color: #baffba !important;
      }
      .retangulo-obs.dark-theme {
        color: #b0b0b0 !important;
      }
      #custom-navbar.dark-theme {
        background: rgba(35,39,43,0.95) !important; box-shadow: 0 2px 8px #0008;
      }
      .nav-btn.dark-theme { color: #baffba !important; background: transparent !important; }
      .nav-btn.dark-theme.active, .nav-btn.dark-theme:focus, .nav-btn.dark-theme:active, .nav-btn.dark-theme:hover { background: #2e3b2e !important; color: #baffba !important; border-bottom: 3px solid #baffba !important; }
      table.dark-theme, th.dark-theme, td.dark-theme { background: #23272b !important; color: #fff !important; border-color: #444 !important; }
      thead.dark-theme, .table-light.dark-theme, .table-title.dark-theme { background: #23272b !important; color: #fff !important; }
      input.dark-theme, select.dark-theme, textarea.dark-theme {
        background: #23272b !important;
        color: #fff !important;
        border: 1px solid #444 !important;
      }
      input.dark-theme::placeholder, select.dark-theme::placeholder, textarea.dark-theme::placeholder {
        color: #bbb !important;
      }
      .btn, .btn-success, .btn-warning, .btn-primary, .btn-danger, .btn-info {
        transition: background 0.2s, color 0.2s;
      }
      .btn.dark-theme, .btn-success.dark-theme, .btn-warning.dark-theme, .btn-primary.dark-theme, .btn-danger.dark-theme, .btn-info.dark-theme {
        background: #333 !important;
        color: #fff !important;
        border: 1px solid #555 !important;
      }
      .btn.dark-theme:hover, .btn-success.dark-theme:hover, .btn-warning.dark-theme:hover, .btn-primary.dark-theme:hover, .btn-danger.dark-theme:hover, .btn-info.dark-theme:hover {
        background: #444 !important;
        color: #baffba !important;
      }
      .form-switch .form-check-input.dark-theme {
        background-color: #23272b !important;
        border-color: #baffba !important;
      }
      .form-switch .form-check-input.dark-theme:checked {
        background-color: #baffba !important;
        border-color: #baffba !important;
      }
      .retangulo-autos.dark-theme { color: #fff !important; background: #23272b !important; }
      .panorama-title.dark-theme {
        color: #fff !important;
        background: rgba(35,39,43,0.65) !important;
      }
    </style>
    <script>
      try {
        if (localStorage.getItem('theme') === 'dark') {
          document.documentElement.classList.add('dark-theme');
          document.body.classList.add('dark-theme');
        }
      } catch(e){}
    </script>
</head>
<body>
    <!--Barra de navegação superior-->
    <div style="width:100%;display:flex;justify-content:flex-start;margin-top:4px;margin-bottom:10px;gap:0;flex-wrap:wrap;position:sticky;top:0;z-index:1001;box-shadow:0 2px 8px #0002;">
        <img id="logo-superend" src="logo-superendividamento.png" alt="SUPERENDIVIDAMENTO" style="max-width:20%; min-width:5%; height:60px; display:block; box-shadow: 0 2px 8px #0001; border-radius: 12px; margin-left:4px; margin-right:0;" />
        <div style="flex:1;justify-content:flex-start; width: 80%; padding-top: 1px; padding-bottom: 1px; margin-left:4px; margin-right:50px;">
            <div id="custom-navbar" style="height: 55px; position:static;box-shadow:none;margin-bottom:2px;border-radius:16px;padding:6px 8px; margin-left:2;">
                <button onclick="navegarComTema('index.html')" class="nav-btn" id="btn-dados">Dados Socioeconômicos</button>
                <button onclick="navegarComTema('geral.html')" class="nav-btn" id="btn-geral">Geral</button>
                <button onclick="navegarComTema('plano-de-pagamento.html')" class="nav-btn" id="btn-plano">Plano de Pagamento</button>
                <button onclick="navegarComTema('panorama.html')" class="nav-btn" id="btn-panorama">Panorama</button>
            </div>
        </div>
    </div>
    <div class="container"; style="background: #ffffff00;">
        <div style="display:flex; align-items:flex-start; justify-content:space-between; margin-bottom:18px; margin-top:-10px; gap:16px;">
            <h2 style="color: #2d5c2f;">PANORAMA MENSAL RESUMIDO</h2>
            <div style="display:flex; flex-direction:column; align-items:center; justify-content:center; flex:1; min-width:180px;">
                <div class="retangulo-autos" style="margin:0 auto; background: #02ee600c; color: #000000; position:static; min-width:160px; text-align:center;">N° Processo: <span id="valor-autos">-</span></div>
            </div>
            <button type="button" class="imprimir-btn btn btn-success mb-3" id="btn-imprimir" onclick="window.print()" >Imprimir</button>
        </div>
        
        <!-- Retângulo 1: Total Rendimentos Mensais Líquidos -->
        <div class="retangulo">
            <div class="retangulo-icone retangulo-icone-dinheiro">💰</div>
            <div class="retangulo-titulo">TOTAL RENDIMENTOS MENSAIS LÍQUIDOS APÓS DESPESAS EXISTENCIAIS</div>
            <div class="retangulo-valor" id="valor-rendimentos">R$ 0,00</div>
        </div>
        <!-- Retângulo 2: Consignadas -->
        <div class="retangulo">
            <div class="retangulo-icone retangulo-icone-folha">🧾</div>
            <div class="retangulo-titulo">SOMA DAS PARCELA(S) CONSIGNADA(S) EM FOLHA:</div>
            <div class="retangulo-valor-neg" id="valor-consignadas">-R$ 0,00</div>
            <div class="retangulo-valor-porcento" id="pct-consignadas">0,00%</div>
        </div>
        <!-- Retângulo 3: Não Consignadas -->
        <div class="retangulo">
            <div class="retangulo-icone retangulo-icone-cartao">💳</div>
            <div class="retangulo-titulo">SOMA DAS PARCELAS NÃO CONSIGNADAS EM FOLHA:</div>
            <div class="retangulo-valor-neg" id="valor-nao-consignadas">-R$ 0,00</div>
            <div class="retangulo-valor-porcento" id="pct-nao-consignadas">0,00%</div>
        </div>
        <!-- Retângulo 4: Comprometido -->
        <div class="retangulo">
            <div class="retangulo-icone retangulo-icone-comprometido">🎯</div>
            <div class="retangulo-titulo">COMPROMETIDO:</div>
            <div class="retangulo-valor-porcento" id="pct-comprometido">0,00% : RENDA COMPROMETIDA EM PARCELAS</div>
            <div class="retangulo-label"><span id="valor-livre-mensal">R$ 0,00</span> : LIVRE MENSAL</div>
        </div>
        <!-- Retângulo 5: Outras Dívidas -->
        <div class="retangulo">
            <div class="retangulo-icone retangulo-icone-outros">📋</div>
            <div class="retangulo-titulo">SOMA DAS OUTRAS DÍVIDAS SEM PARCELAS MENSAIS ATUAIS:</div>
            <div class="retangulo-label">- <span id="valor-sem-parcelas">R$ 0,00</span> : TOTAL DAS DÍVIDAS SEM PARCELAS HOJE</div>
            <div class="retangulo-label"><span id="valor-parcelamento-60">R$ 0,00</span> : PARCELAMENTO DESSAS DÍVIDAS EM 60 MESES</div>
            <div class="retangulo-label">- <span id="valor-total-parcelas">R$ 0,00</span> : PARCELA MENSAL DE TODAS AS DÍVIDAS SOMADAS</div>
            <div class="retangulo-label"><span id="valor-livre-mensal-consolidado">R$ 0,00</span> : LIVRE MENSAL CONSOLIDADO</div>
            <div class="retangulo-valor-porcento" id="pct-comprometido-total">0,00% : RENDA COMPROMETIDA COM TODA DÍVIDA</div>
        </div>
        <!-- Retângulo 6: Emergencial -->
        <div class="retangulo retangulo-verde">
            <div class="retangulo-icone retangulo-icone-alarme">🚨</div>
            <div class="retangulo-titulo">EMERGENCIAL ATÉ FASE DE MEDIAÇÃO E/OU INSTRUÇÃO:</div>
            <div class="retangulo-pct-limite" id="pct-limite">0%</div>
            <div class="retangulo-label"><span id="valor-renda-sem-consignados">R$ 0,00</span> : RENDA SEM OS DÉBITOS CONSIGNADOS</div>
            <div class="retangulo-label"><span id="valor-consignacao-emergencial">R$ 0,00</span> : CONSIGNAÇÃO EMERGENCIAL</div>
            <div class="retangulo-label"><span id="valor-livre-emergencial">R$ 0,00</span> : LIVRE PARA OUTRAS DESPESAS (EXISTENCIAIS E FORA DO PLANO)</div>
        </div>
        <div class="retangulo-obs">
            <b>Como usar esta aplicação:</b><br>
            1. <b>Inicie pela página <u>Dados Socioeconômicos</u></b>:<br>
            &nbsp;&nbsp;- Preencha todas as receitas (rendas) e despesas do consumidor ou família.<br>
            &nbsp;&nbsp;- Para cada receita, você pode relatar um evento (campo texto) e a data/hora será salva automaticamente.<br>
            &nbsp;&nbsp;- O valor mensal após despesas existenciais será calculado automaticamente.<br>
            <br>
            2. <b>Vá para a página <u>Geral</u></b>:<br>
            &nbsp;&nbsp;- Preencha as dívidas nas tabelas: CONSIGNADOS, NÃO CONSIGNADOS, SEM PARCELAS e DÍVIDAS CONSOLIDADAS.<br>
            &nbsp;&nbsp;- A tabela <b>Rendimentos</b> será preenchida automaticamente com as receitas cadastradas na primeira página, incluindo evento e data.<br>
            <br>
            3. <b>Vá para a página <u>Plano de Pagamento</u></b>:<br>
            &nbsp;&nbsp;- Escolha o número de parcelas e ajuste a porcentagem da renda a ser utilizada para o parcelamento das dívidas.<br>
            &nbsp;&nbsp;- O sistema calcula automaticamente o valor das parcelas, o comprometimento da renda e o valor livre mensal.<br>
            <br>
            4. <b>Por fim, acesse a página <u>Panorama</u></b>:<br>
            &nbsp;&nbsp;- Esta página é apenas informativa e exibe um resumo visual de todos os dados preenchidos nas etapas anteriores.<br>
            <br>
            <a href="https://www.cnj.jus.br/wp-content/uploads/2022/08/cartilha-superendividamento.pdf" target="_blank" style="font-weight:bold; color:#007a00; text-decoration:underline;">Veja a Cartilha Superendividamento</a>
            <br>
            <b>Observações importantes:</b><br>
            - O uso correto da aplicação depende do preenchimento sequencial das páginas.<br>
            - As tabelas de dívidas devem ser preenchidas conforme a natureza de cada dívida.<br>
            - Os dados são salvos localmente no navegador (localStorage).<br>
        </div>
    </div>
    <!-- Botão de tema pequeno e redondo -->
    <button id="btn-theme-toggle" type="button" title="Alternar tema" style="position:fixed;top:13px;right:8px;width:36px;height:36px;border-radius:50%;background:#e0ffe0;border:none;box-shadow:0 2px 8px #0002;display:flex;align-items:center;justify-content:center;font-size:1.2em;z-index:2000;cursor:pointer;transition:background 0.2s;">
      🌙
    </button>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
    // Função para formatar valores em BRL
    function formatBRL(value) {
        if (isNaN(value)) return 'R$ 0,00';
        return value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
    }

    function getValorTotalParcelas() {
        // Buscar o valor total das parcelas do plano de pagamento (soma de todas as parcelas de um mês)
        let valorTotalParcelaPlano = 0;
        
        // Tentar buscar do localStorage
        const totalParcelaStr = localStorage.getItem('plano-valor-total-parcela');
        if (totalParcelaStr) {
            const valor = parseFloat(totalParcelaStr);
            if (!isNaN(valor)) {
                valorTotalParcelaPlano = valor;
            }
        }
        
        return valorTotalParcelaPlano;
    }

    function getValueFromLocalStorage(key, fallback=0) {
        const v = localStorage.getItem(key);
        return v ? parseFloat(v) : fallback;
    }
    function limparCampos() {
        document.querySelectorAll('input[type="text"], input[type="number"]').forEach(function(input) {
            input.value = '';
            if (input.id) localStorage.removeItem(input.id);
        });
        // Atualizar campos visuais se necessário
        location.reload();
    }
    function atualizarPanorama() {
        // 1. Buscar valor final de dados-socioeconomicos.html (após despesas existenciais)
        let valorRendimentos = getValueFromLocalStorage('valor-final', 0);
        document.getElementById('valor-rendimentos').textContent = formatBRL(valorRendimentos);

        // 2. Buscar número dos autos da página geral.html
        document.getElementById('valor-autos').textContent = localStorage.getItem('numero-processo') || '-';

        // 3. Calcular soma das parcelas consignadas
        let valorConsignadas = 0;
        const linhasConsignados = JSON.parse(localStorage.getItem('linhas-consignados') || '[]');
        linhasConsignados.forEach(linha => {
            const parcelaMensal = parseFloat(linha.parcelaMensal?.replace(/\./g, '').replace(',', '.')) || 0;
            valorConsignadas += parcelaMensal;
        });

        // Atualizar valor e porcentagem das consignadas
        document.getElementById('valor-consignadas').textContent = '-' + formatBRL(valorConsignadas);
        const pctConsignadas = valorRendimentos > 0 ? (valorConsignadas / valorRendimentos) * 100 : 0;
        document.getElementById('pct-consignadas').textContent = pctConsignadas.toFixed(2) + '%';

        // 4. Calcular soma das parcelas não consignadas
        let valorNaoConsignadas = 0;
        const linhasNaoConsignados = JSON.parse(localStorage.getItem('linhas-nao-consignados') || '[]');
        linhasNaoConsignados.forEach(linha => {
            const parcelaMensal = parseFloat(linha.parcelaMensal?.replace(/\./g, '').replace(',', '.')) || 0;
            valorNaoConsignadas += parcelaMensal;
        });
        // Atualizar valor e porcentagem das não consignadas
        document.getElementById('valor-nao-consignadas').textContent = '-' + formatBRL(valorNaoConsignadas);
        const pctNaoConsignadas = valorRendimentos > 0 ? (valorNaoConsignadas / valorRendimentos) * 100 : 0;
        document.getElementById('pct-nao-consignadas').textContent = pctNaoConsignadas.toFixed(2) + '%';

        // 5. Comprometido (corrigido)
        // Buscar o total da coluna "Valor da Parcela" do plano de pagamento
        let valorTotalParcelasPlano = parseFloat(localStorage.getItem('plano-valor-total-parcela')) || 0;
        // Buscar a receita mensal após despesas (valor-final)
        let receitaAposDespesas = valorRendimentos;
        // Calcular porcentagem comprometida
        let pctComprometidaCorreta = receitaAposDespesas > 0 ? (valorTotalParcelasPlano / receitaAposDespesas) * 100 : 0;
        document.getElementById('pct-comprometido').textContent = `${pctComprometidaCorreta.toFixed(2)}% : RENDA COMPROMETIDA EM PARCELAS`;
        // Calcular valor livre mensal correto
        let valorLivreMensalCorreto = receitaAposDespesas - valorTotalParcelasPlano;
        document.getElementById('valor-livre-mensal').textContent = formatBRL(valorLivreMensalCorreto);

        // 6. Outras Dívidas (corrigido para saldo devedor das sem parcelas)
        let linhasSemParcelas = JSON.parse(localStorage.getItem('linhas-sem-parcelas') || '[]');
        let totalSaldoDevedorSemParcelas = 0;
        linhasSemParcelas.forEach(linha => {
            if (linha.credor && linha.credor !== '') {
                totalSaldoDevedorSemParcelas += parseFloat(linha.saldoDevedor) || 0;
            }
        });
        let valorParcelamento60 = totalSaldoDevedorSemParcelas / 60;
        document.getElementById('valor-sem-parcelas').textContent = formatBRL(totalSaldoDevedorSemParcelas);
        document.getElementById('valor-parcelamento-60').textContent = formatBRL(valorParcelamento60);

        // Restante mantido
        let valorTotalParcelasPlano2 = parseFloat(localStorage.getItem('plano-valor-total-parcela')) || 0;
        let valorLivreMensalConsolidadoCorreto = valorRendimentos - valorTotalParcelasPlano2;
        let pctComprometidoTotalCorreto = valorRendimentos > 0 ? (valorTotalParcelasPlano2 / valorRendimentos) * 100 : 0;
        document.getElementById('valor-total-parcelas').textContent = '-' + formatBRL(valorTotalParcelasPlano2);
        document.getElementById('valor-livre-mensal-consolidado').textContent = formatBRL(valorLivreMensalConsolidadoCorreto);
        document.getElementById('pct-comprometido-total').textContent = pctComprometidoTotalCorreto.toFixed(2) + '% : RENDA COMPROMETIDA COM TODA DÍVIDA';

        // 7. Emergencial (mantido)
        let pctLimite = getValueFromLocalStorage('plano-pct-limite', 30); // Default para 30%
        let valorRendaSemConsignados = valorRendimentos;
        let valorConsignacaoEmergencial = -(pctLimite / 100) * valorRendaSemConsignados;
        let valorLivreEmergencial = valorRendaSemConsignados + valorConsignacaoEmergencial;

        document.getElementById('pct-limite').textContent = pctLimite + '%';
        document.getElementById('valor-renda-sem-consignados').textContent = formatBRL(valorRendaSemConsignados);
        document.getElementById('valor-consignacao-emergencial').textContent = formatBRL(valorConsignacaoEmergencial);
        document.getElementById('valor-livre-emergencial').textContent = formatBRL(valorLivreEmergencial);
    }
    window.onload = atualizarPanorama;

    // Atualizar quando houver mudanças no localStorage
    window.addEventListener('storage', function(e) {
        if (e.key === 'valor-final' || e.key === 'plano-pct-limite' || e.key === 'plano-qtde-parcelas') {
            atualizarPanorama();
        }
    });

    // Ativa o botão da página atual
    const page = window.location.pathname.split('/').pop();
    document.getElementById('btn-dados').classList.remove('active');
    document.getElementById('btn-geral').classList.remove('active');
    document.getElementById('btn-plano').classList.remove('active');
    document.getElementById('btn-panorama').classList.remove('active');
    if(page.includes('index')) document.getElementById('btn-dados').classList.add('active');
    if(page.includes('geral')) document.getElementById('btn-geral').classList.add('active');
    if(page.includes('plano-de-pagamento')) document.getElementById('btn-plano').classList.add('active');
    if(page.includes('panorama')) document.getElementById('btn-panorama').classList.add('active');

    // === DARK MODE (copiado/adaptado da index.html) ===
    const themeToggleBtn = document.getElementById('btn-theme-toggle');
    function setTheme(dark) {
        if (dark) {
            document.body.classList.add('dark-theme');
            document.querySelectorAll('.container').forEach(el => el.classList.add('dark-theme'));
            document.querySelectorAll('.container, #custom-navbar, .nav-btn, table, th, td, thead, .table-light, .table-title, input, select, textarea, .btn, .btn-success, .btn-warning, .btn-primary, .btn-danger, .btn-info, .form-check-input, .valor-final, .obs, h1, h2, h3, h4, h5, h6').forEach(el => el.classList.add('dark-theme'));
            document.querySelectorAll('tfoot, tfoot tr, tfoot .total-row').forEach(el => el.classList.add('dark-theme'));
            themeToggleBtn.textContent = '\u2600\ufe0f';
            localStorage.setItem('theme', 'dark');
            // Força dark-theme em todos os th e td das tabelas
            document.querySelectorAll('table').forEach(table => {
                table.querySelectorAll('th, td').forEach(cell => cell.classList.add('dark-theme'));
            });
        } else {
            document.body.classList.remove('dark-theme');
            document.querySelectorAll('.container').forEach(el => el.classList.remove('dark-theme'));
            document.querySelectorAll('.container, #custom-navbar, .nav-btn, table, th, td, thead, .table-light, .table-title, input, select, textarea, .btn, .btn-success, .btn-warning, .btn-primary, .btn-danger, .btn-info, .form-check-input, .valor-final, .obs, h1, h2, h3, h4, h5, h6').forEach(el => el.classList.remove('dark-theme'));
            document.querySelectorAll('tfoot, tfoot tr, tfoot .total-row').forEach(el => el.classList.remove('dark-theme'));
            themeToggleBtn.textContent = '\ud83c\udf19';
            localStorage.setItem('theme', 'light');
            // Remove dark-theme de todos os th e td das tabelas
            document.querySelectorAll('table').forEach(table => {
                table.querySelectorAll('th, td').forEach(cell => cell.classList.remove('dark-theme'));
            });
        }
    }
    themeToggleBtn.addEventListener('click', function() {
        const dark = !document.documentElement.classList.contains('dark-theme');
        localStorage.setItem('theme', dark ? 'dark' : 'light');
        location.reload();
    });
    window.addEventListener('DOMContentLoaded', function() {
        setTimeout(function() {
            const saved = localStorage.getItem('theme');
            setTheme(saved === 'dark');
            // Garante que todos os retângulos recebam a classe dark-theme se o tema for escuro
            if (saved === 'dark') {
                document.querySelectorAll('.retangulo').forEach(el => el.classList.add('dark-theme'));
                document.querySelectorAll('.retangulo-verde').forEach(el => el.classList.add('dark-theme'));
            } else {
                document.querySelectorAll('.retangulo').forEach(el => el.classList.remove('dark-theme'));
                document.querySelectorAll('.retangulo-verde').forEach(el => el.classList.remove('dark-theme'));
            }
        }, 0);
    });
    function trocarLogoPorTema(dark) {
        var logo = document.getElementById('logo-superend');
        if (!logo) return;
        logo.src = dark ? 'logo-superendividamento-Dark.png' : 'logo-superendividamento.png';
    }
    function trocarBgPorTema(dark) {
        document.body.style.backgroundImage = dark ? "url('SuperEndBackgroundTransparente-Dark.png')" : "url('SuperEndBackgroundTransparente.png')";
    }
    // Adapte a função setTheme existente:
    const oldSetTheme = setTheme;
    setTheme = function(dark) {
        oldSetTheme(dark);
        trocarLogoPorTema(dark);
        trocarBgPorTema(dark);
    }
    window.addEventListener('DOMContentLoaded', function() {
        setTimeout(function() {
            const saved = localStorage.getItem('theme');
            trocarLogoPorTema(saved === 'dark');
            trocarBgPorTema(saved === 'dark');
        }, 0);
    });

    // Adicionar função global:
    function navegarComTema(destino) {
        const dark = document.documentElement.classList.contains('dark-theme');
        localStorage.setItem('theme', dark ? 'dark' : 'light');
        window.location.href = destino;
    }
    </script>
</body>
</html> 